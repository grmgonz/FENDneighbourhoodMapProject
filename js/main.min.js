function initMap(a){"use strict";var b=[{featureType:"water",elementType:"geometry",stylers:[{color:"#cc66ff"},{lightness:17}]}];infowindow=new google.maps.InfoWindow({content:"<div style = 'width:300px;min-height:150px'>"}),map=new google.maps.Map(document.getElementById("map"),{center:{lat:43.658324,lng:-79.370928},zoom:14,styles:b,mapTypeControl:!1});for(var c={url:"img/school.svg",size:new google.maps.Size(64,64),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,64)},d={url:"img/school2.svg",size:new google.maps.Size(64,64),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,64)},e=0;e<ViewModel.allSchools().length;e++){var f=schools[e].name,g=schools[e].website,h=new google.maps.LatLng(schools[e].latitude,schools[e].longitude);marker[e]=new google.maps.Marker({map:map,icon:c,title:f,content:g,animation:google.maps.Animation.DROP,position:h}),google.maps.event.addListener(marker[e],"click",function(){ViewModel.displayWikiInfo(this)}),google.maps.event.addListener(marker[e],"mouseover",function(){this.setIcon(d)}),google.maps.event.addListener(marker[e],"mouseout",function(){this.setIcon(c)})}ko.applyBindings(ViewModel)}function toggleBounce(a){null!==a.getAnimation()?a.setAnimation(null):(a.setAnimation(google.maps.Animation.BOUNCE),window.setTimeout(function(){a.setAnimation(null)},1400))}function googleError(){"undefined"==typeof $?$("#map").html("Fail to load Google maps"):document.getElementById("map").innerHTML='<div class="fail">!Sorry, failed to load Google maps...!</div>'}var map,marker=[],infowindow,schools=[{name:"University of Toronto",latitude:43.662891,longitude:-79.395651,website:"https://www.utoronto.ca/"},{name:"Wilfred Laurier University",latitude:43.648409,longitude:-79.383386,website:"https://www.wlu.ca/"},{name:"Ryerson University",latitude:43.657657,longitude:-79.378805,website:"http://www.ryerson.ca/index.html"},{name:"OCAD University",latitude:43.651996,longitude:-79.389098,website:"http://www.ocadu.ca/"},{name:"George Brown College",latitude:43.650952,longitude:-79.370225,website:"http://www.georgebrown.ca/"},{name:"Centennial College",latitude:43.653229,longitude:-79.383185,website:"http://www.centennialcollege.ca/"},{name:"Lighthouse Labs",latitude:43.644645,longitude:-79.394973,website:"https://www.lighthouselabs.ca/"}],ViewModel={allSchools:ko.observableArray(schools),filtering:ko.observable(""),displayWikiInfo:function(a){infowindow.open(map,a),toggleBounce(a);for(var b,c=0;c<schools.length;c++)a.position.lat().toPrecision(8)==schools[c].latitude.toPrecision(8)&&a.position.lng().toPrecision(8)==schools[c].longitude.toPrecision(8)&&(b=schools[c].name);var d="https://en.wikipedia.org/w/api.php?action=opensearch&search="+b+"&format=json";$.ajax({url:d,dataType:"jsonp"}).done(function(b){if(infowindow.marker!=a){infowindow.marker=a;for(var c="View School's Website Here",d=0;d<1;d++)if(b[1][d]){var e="<div><h2>"+a.title+"</h2><p>"+b[2][d]+'</p><a href="'+b[3][1]+'"target="_blank"><p class="via">Info via Wikipedia</p></a><h4><a href=" '+a.content+'" target="_blank">'+c+"</a></h4></div>";infowindow.setContent(e)}else{var f="<div><h5>Sorry, we could not find Wikipedia information about this school.</h5></div>";infowindow.setContent(f)}}}).fail(function(){var a="<div><h5>OOPS, content from Wikipedia has failed to load</h5></div>";infowindow.setContent(a)})},schoolClicked:function(a){for(var b,c=0;c<schools.length;c++)schools[c].name===a.name&&(b=c);ViewModel.displayWikiInfo(marker[b])},search:function(a){ViewModel.allSchools([]);for(var b=0;b<marker.length;b++)marker[b].setVisible(!1);for(var c in schools)schools[c].name.toLowerCase().indexOf(a.toLowerCase())>=0&&(ViewModel.allSchools.push(schools[c]),marker[c].setVisible(!0))}};ViewModel.filtering.subscribe(ViewModel.search);